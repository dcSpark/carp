<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-indexer/docker">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<title data-rh="true">Starting Carp in container | Carp Documentation</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dcspark.github.io/carp/docs/indexer/docker"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Starting Carp in container | Carp Documentation"><meta data-rh="true" name="description" content="Carp can be run using docker-compose. It creates 4 (+1 optional) services:"><meta data-rh="true" property="og:description" content="Carp can be run using docker-compose. It creates 4 (+1 optional) services:"><link data-rh="true" rel="icon" href="/carp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://dcspark.github.io/carp/docs/indexer/docker"><link data-rh="true" rel="alternate" href="https://dcspark.github.io/carp/docs/indexer/docker" hreflang="en"><link data-rh="true" rel="alternate" href="https://dcspark.github.io/carp/docs/indexer/docker" hreflang="x-default"><link rel="stylesheet" href="/carp/assets/css/styles.3647f44a.css">
<link rel="preload" href="/carp/assets/js/runtime~main.7824f293.js" as="script">
<link rel="preload" href="/carp/assets/js/main.21ef10b6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/carp/"><div class="navbar__logo"><img src="/carp/img/logo.svg" alt="Carp Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/carp/img/logo.svg" alt="Carp Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Carp Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carp/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/carp/openapi">OpenAPI / Swagger</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/dcSpark/carp/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carp/docs/intro">Carp (Cardano Postgres Indexer)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carp/docs/pitfalls">Pitfalls, Risks &amp; Limitations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carp/docs/comparison">Carp vs alternatives</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/carp/docs/category/carp-indexer">Carp Indexer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Carp Indexer&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/example_plan">Example Execution Plan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/run">Running</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/migrations">Migrations &amp; Rollbacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/add_task">Adding your own task</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carp/docs/indexer/sql">SQL Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/carp/docs/indexer/docker">Starting Carp in container</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/carp/docs/indexer/Tasks/">Tasks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tasks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carp/docs/category/carp-webserver">Carp Webserver</a><button aria-label="Toggle the collapsible sidebar category &#x27;Carp Webserver&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carp/docs/requirements">Minimum requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carp/docs/using">Project using Carp</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/carp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/carp/docs/category/carp-indexer"><span itemprop="name">Carp Indexer</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Starting Carp in container</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Starting Carp in container</h1><p>Carp can be run using <code>docker-compose</code>. It creates 4 (+1 optional) services:</p><ul><li>postgres - container running postgres database</li><li>cardano-node - container running cardano-node</li><li>carp - container build locally with carp</li><li>carp_web - webserver for carp</li></ul><p>To run docker deployment you will need to configure .env file, carp&#x27;s config. We&#x27;ve prepared the necessary configs to run the whole deployment for mainnet. You can run with other networks using the instructions below. </p><p>Run the deployment with the following command from <code>deployment</code> folder:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> compose --env-file config/indexer/docker.env up -d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Setup assumes ports 3000, 3001 and 5432 are available.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backup-service">Backup service<a class="hash-link" href="#backup-service" title="Direct link to heading">​</a></h2><p>There is an optional container that can perform back of the database to a s3 bucket.
It checks every hour the cardano-node tip epoch and if it changes, an SQL backup is being generated.
By default, the backup service is commented out. At the moment only mainnet and testnet are supported by backuper.</p><p>Backup service will upload file to path:
<code>s3://${S3_BUCKET}/${S3_FOLDER}/${NETWORK}/</code></p><p><strong>WARNING:</strong>
Starting Carp with backup service from scratch will create a dozens of backups until cardano-node fully synchronizes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-setup">Environment setup<a class="hash-link" href="#environment-setup" title="Direct link to heading">​</a></h2><p>Some environment variables must be set up to ensure successful running of all containers. We&#x27;ve prepared an example .env file: <a href="https://github.com/dcSpark/carp/blob/main/deployment/config/indexer/docker.env" target="_blank" rel="noopener noreferrer">docker.env</a>. It contains mandatory variables already:</p><div class="language-dotenv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dotenv codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># network can be mainnet/preview/preprod/testnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># this parameter is utilized by migration service and docker-compose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NETWORK=mainnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># can be cardano_node_docker.yml or oura_docker.yml or </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># any custom filename located in deployment/config/indexer folder </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># alternative to CARP_CONFIG env variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONFIG_FILE=cardano_node_docker.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CARP_VERSION=3.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># these credentials are utilized by postgres, carp and carp_web services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># host should be container name or static ip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_HOST=postgres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_PORT=5432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">POSTGRES_DB=carp_mainnet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PGUSER=carp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PGPASSWORD=1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PGPASSFILE=&quot;$(realpath secrets/.pgpass)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># note: PGPASSWORD isn&#x27;t required to run carp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># since it will be parsed from the PGPASSFILE instead</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># as this command will gracefully fallback to PGPASSFILE if no password is specified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># However, some dev tools like pgtyped &amp; zapatos don&#x27;t support .pgpass files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATABASE_URL=postgresql://${PGUSER}:${PGPASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please set <code>NETWORK</code>, <code>CONFIG_FILE</code> and postgres variables carefully. <code>CONFIG_FILE</code> should be located in <code>deployment/config/indexer</code> folder. You can use <code>CARP_CONFIG</code> env variable instead of <code>CONFIG_FILE</code> if you want to use just env variables for configuration.</p><p>You can also add non-mandatory variables that are useful for backuper:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># optional content for backup service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">S3_BUCKET</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">name of bucket to store backups</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">S3_FOLDER</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">name of folder inside s3 bucket. I recommend </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">AWS_ACCESS_KEY_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Access key </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> given s3 bucket with creation permissions</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">AWS_SECRET_ACCESS_KEY</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Secret </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> given account</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pgpass-location"><code>.pgpass</code> location<a class="hash-link" href="#pgpass-location" title="Direct link to heading">​</a></h2><p><code>.pgpass</code> file should be stored in <code>deployment/config/secrets/&lt;NETWORK&gt;/.pgpass</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="carp-configuration">Carp configuration<a class="hash-link" href="#carp-configuration" title="Direct link to heading">​</a></h2><p>We mentioned config files above, they should be stored in <code>deployment/config/indexer</code> folder, and you should set <code>CONFIG_FILE</code> env variable with the config name. Alternatively you can set <code>CARP_CONFIG</code> env variable and not use the configuration file</p><p>The difference from non-docker configuration is in the networking mainly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sink-configuration-changes">Sink configuration changes<a class="hash-link" href="#sink-configuration-changes" title="Direct link to heading">​</a></h3><p>For sink you should set host to postgres container name from docker-compose: <code>postgres</code>. Other logic is the same. This change is mandatory, since docker network resolution uses container names (ips are non-static in general case and localhost won&#x27;t work either)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="source-configuration-changes">Source configuration changes<a class="hash-link" href="#source-configuration-changes" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="oura">Oura<a class="hash-link" href="#oura" title="Direct link to heading">​</a></h4><p>For oura source you can use <code>Unix</code> socket:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> oura</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">socket</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/app/node-ipc/node.socket&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">bearer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Unix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively you can use <code>Tcp</code> as well:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> oura</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">socket</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;172.20.0.4:3001&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">bearer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Tcp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cardano_net">Cardano_net<a class="hash-link" href="#cardano_net" title="Direct link to heading">​</a></h4><p>For <code>cardano_net</code> you can use <code>Tcp</code> only:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cardano_net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">relay</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 172.20.0.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3001</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note</strong>: <code>cardano-node</code> container has static ip <code>172.20.0.4</code> in docker-compose.</p><p><strong>WARNING</strong>: <code>cardano_net</code> can&#x27;t resolve docker names itself, that&#x27;s why static ip is assigned.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a class="hash-link" href="#troubleshooting" title="Direct link to heading">​</a></h2><p>Docker deployment shares with local filesystem in paths:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># cardano-node container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NETWORK</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/node-ipc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NETWORK</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/node-db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># postgres container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NETWORK</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/postgres-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># carp container</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NETWORK</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/node-ipc </span><span class="token comment" style="color:#999988;font-style:italic"># to read unix socket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment/config/indexer/ </span><span class="token comment" style="color:#999988;font-style:italic"># to get config for carp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If at any point you broke the consistency (by running multiple deployments with access to the same folders / running incompatible software versions), you can remove non-config folders from above (but all progress will be <strong>lost</strong>).</p><p>Don&#x27;t hesitate to submit issues to <a href="https://github.com/dcSpark/carp/issues" target="_blank" rel="noopener noreferrer">carp repository</a> as well.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dcSpark/carp/docs/indexer/docker.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/carp/docs/indexer/sql"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SQL Format</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/carp/docs/indexer/Tasks/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tasks</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#backup-service" class="table-of-contents__link toc-highlight">Backup service</a></li><li><a href="#environment-setup" class="table-of-contents__link toc-highlight">Environment setup</a></li><li><a href="#pgpass-location" class="table-of-contents__link toc-highlight"><code>.pgpass</code> location</a></li><li><a href="#carp-configuration" class="table-of-contents__link toc-highlight">Carp configuration</a><ul><li><a href="#sink-configuration-changes" class="table-of-contents__link toc-highlight">Sink configuration changes</a></li><li><a href="#source-configuration-changes" class="table-of-contents__link toc-highlight">Source configuration changes</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/carp/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Assets</div><ul class="footer__items clean-list"><li class="footer__item">
                  <a class="footer__link-item" href="/carp/CARP-assets.zip" target="_blank" rel="noreferrer noopener">Brand assets</a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/dcspark" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dcspark_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 dcSpark</div></div></div></footer></div>
<script src="/carp/assets/js/runtime~main.7824f293.js"></script>
<script src="/carp/assets/js/main.21ef10b6.js"></script>
</body>
</html>